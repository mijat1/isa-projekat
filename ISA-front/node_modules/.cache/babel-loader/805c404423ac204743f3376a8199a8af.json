{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\amijatovic\\\\Desktop\\\\isa\\\\ISA-projekat-main\\\\ISA-front\\\\src\\\\Components\\\\Pharmacies\\\\PharmacyPage.js\";\nimport React, { Component } from \"react\";\nimport Header from '../Header';\nimport Axios from \"axios\";\nimport { YMaps, Map, Placemark } from \"react-yandex-maps\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport GetAuthorisation from \"../../Funciton/GetAuthorisation\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = \"http://localhost:8080\";\n\nclass PharmacyPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pharmacy: \"\",\n      phId: \"\",\n      nameOfPharmacy: \"Benu\",\n      description: \"\",\n      grade: \"\",\n      adress: '',\n      lat: \"\",\n      long: \"\",\n      isEditable: false,\n      consultationPrice: 0,\n      nameError: \"none\",\n      descriptionError: \"none\",\n      addressError: \"none\",\n      consultationPriceError: \"none\",\n      showModal: false,\n      showModalErr: false\n    };\n\n    this.handleChangeInfo = () => {\n      let street;\n      let city;\n      let country;\n      let latitude;\n      let longitude;\n      let address1;\n      let postCode = '10000';\n      address1 = this.addressInput.current.value;\n      var com = address1.split(\",\");\n      console.log(com[0]);\n      this.ymaps.geocode(this.addressInput.current.value).then(function (res) {\n        var addressObject = res.geoObjects.get(0),\n            coords = addressObject.geometry.getCoordinates();\n        latitude = coords[0];\n        longitude = coords[1];\n        country = addressObject.getCountry();\n        street = addressObject.getThoroughfare();\n        city = addressObject.getLocalities().join(\", \");\n      }).then(res => {\n        let phId = this.state.phId;\n        let pharmacyDTO = {\n          name: this.state.nameOfPharmacy,\n          address: {\n            city,\n            street,\n            country,\n            postCode,\n            latitude,\n            longitude\n          },\n          description: this.state.description,\n          consultationPrice: this.state.consultationPrice\n        };\n\n        if (this.validateForm(pharmacyDTO)) {\n          Axios.put(API_URL + \"/pharmacy/editPharmacy/\" + phId, pharmacyDTO, {\n            validateStatus: () => true,\n            headers: {\n              Authorization: GetAuthorisation()\n            }\n          }).then(res => {\n            if (res.status === 400) {\n              this.setState({\n                showModalErr: true\n              });\n            } else if (res.status === 204) {\n              console.log(\"Success\");\n              this.setState({\n                showModal: true\n              });\n            }\n          }).catch(err => {\n            console.log(err);\n          });\n        }\n      });\n    };\n\n    this.validateForm = pharmacyDTO => {\n      this.setState({\n        nameError: \"none\",\n        descriptionError: \"none\",\n        addressError: \"none\",\n        consultationPriceError: \"none\"\n      });\n\n      if (pharmacyDTO.name === \"\") {\n        this.setState({\n          nameError: \"initial\"\n        });\n        return false;\n      } else if (pharmacyDTO.description === \"\") {\n        this.setState({\n          descriptionError: \"initial\"\n        });\n        return false;\n      } else if (this.addressInput.current.value === \"\") {\n        this.setState({\n          addressError: \"initial\"\n        });\n        return false;\n      } else if (pharmacyDTO.consultationPrice === \"\") {\n        this.setState({\n          consultationPriceError: \"initial\"\n        });\n        return false;\n      }\n\n      return true;\n    };\n\n    this.isEditableInfoFields = () => {\n      this.setState({\n        isEditable: true\n      });\n    };\n\n    this.handleNameChange = event => {\n      this.setState({\n        nameOfPharmacy: event.target.value\n      });\n    };\n\n    this.handleDescriptionChange = event => {\n      this.setState({\n        description: event.target.value\n      });\n    };\n\n    this.handleConsultationPriceChange = event => {\n      this.setState({\n        consultationPrice: event.target.value\n      });\n    };\n\n    this.handleCloseModal = () => {\n      this.setState({\n        showModal: false,\n        showModalErr: false\n      });\n    };\n\n    this.addressSuggestView = ymaps => {\n      this.ymaps = ymaps;\n\n      if (this.state.address !== \"\") {\n        this.ymaps.geocode([this.state.address.latitude, this.state.address.longitude]).then(function (res) {\n          var firstGeoObject = res.geoObjects.get(0);\n          document.getElementById(\"suggest\").setAttribute(\"value\", firstGeoObject.getAddressLine());\n        });\n        const suggestView = new ymaps.SuggestView(\"suggest\");\n      }\n    };\n\n    this.addressInput = /*#__PURE__*/React.createRef();\n  }\n\n  componentDidMount() {\n    this.addressInput = /*#__PURE__*/React.createRef();\n    Axios.get(API_URL + \"/pharmacy/pharmacyInfo/\" + localStorage.getItem(\"keyPharmacyId\"), {\n      headers: {\n        Authorization: GetAuthorisation()\n      }\n    }).then(response => {\n      this.setState({\n        pharmacy: response.data,\n        phId: response.data.Id,\n        nameOfPharmacy: response.data.EntityDTO.name,\n        description: response.data.EntityDTO.description,\n        address: response.data.EntityDTO.address,\n        lat: response.data.EntityDTO.address.latitude,\n        long: response.data.EntityDTO.address.longitude,\n        grade: response.data.EntityDTO.grade,\n        consultationPrice: response.data.EntityDTO.price\n      });\n      console.log(this.state.address.latitude);\n      console.log(this.state.address.longitude);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  render() {\n    const nameOfPharmacy = this.state.nameOfPharmacy;\n    return /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-xs-8\",\n        style: {\n          marginLeft: '3%'\n        },\n        children: /*#__PURE__*/_jsxDEV(YMaps, {\n          query: {\n            load: \"package.full\",\n            lang: \"en_US\",\n            apikey: \"b0ea2fa3-aba0-4e44-a38e-4e890158ece2\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Map, {\n            width: \"33em\",\n            height: \"470px\",\n            onLoad: this.addressSuggestView,\n            defaultState: {\n              center: [this.state.lat, this.state.long],\n              zoom: 15\n            },\n            modules: [\"SuggestView\"],\n            children: /*#__PURE__*/_jsxDEV(Placemark, {\n              geometry: [this.state.lat, this.state.long],\n              properties: {\n                balloonContent: this.state.nameOfPharmacy\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 4\n    }, this);\n  }\n\n}\n\nexport default PharmacyPage;","map":{"version":3,"sources":["C:/Users/amijatovic/Desktop/isa/ISA-projekat-main/ISA-front/src/Components/Pharmacies/PharmacyPage.js"],"names":["React","Component","Header","Axios","YMaps","Map","Placemark","Button","Modal","GetAuthorisation","API_URL","PharmacyPage","constructor","props","state","pharmacy","phId","nameOfPharmacy","description","grade","adress","lat","long","isEditable","consultationPrice","nameError","descriptionError","addressError","consultationPriceError","showModal","showModalErr","handleChangeInfo","street","city","country","latitude","longitude","address1","postCode","addressInput","current","value","com","split","console","log","ymaps","geocode","then","res","addressObject","geoObjects","get","coords","geometry","getCoordinates","getCountry","getThoroughfare","getLocalities","join","pharmacyDTO","name","address","validateForm","put","validateStatus","headers","Authorization","status","setState","catch","err","isEditableInfoFields","handleNameChange","event","target","handleDescriptionChange","handleConsultationPriceChange","handleCloseModal","addressSuggestView","firstGeoObject","document","getElementById","setAttribute","getAddressLine","suggestView","SuggestView","createRef","componentDidMount","localStorage","getItem","response","data","Id","EntityDTO","price","render","marginLeft","load","lang","apikey","center","zoom","balloonContent"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Header from '../Header';\nimport Axios from \"axios\";\nimport { YMaps, Map,Placemark } from \"react-yandex-maps\";\n\nimport { Button, Modal } from \"react-bootstrap\";\n\n\nimport GetAuthorisation from \"../../Funciton/GetAuthorisation\";\n\nconst API_URL=\"http://localhost:8080\";\n\n\nclass PharmacyPage extends Component {\n\tstate = {\n\t\tpharmacy: \"\",\n\t\tphId: \"\",\n\t\tnameOfPharmacy: \"Benu\",\n\t\tdescription: \"\",\n        grade: \"\",\n        adress:'',\n\t\t\n\t\tlat: \"\",\n\t\tlong: \"\",\n        isEditable: false,\n\t\tconsultationPrice:0,\n\t\tnameError: \"none\",\n\t\tdescriptionError: \"none\",\n\t\taddressError: \"none\",\n\t\tconsultationPriceError: \"none\",\n\t\tshowModal : false,\n\t\tshowModalErr   : false\n\n    };\n    \n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.addressInput = React.createRef();\n\t}\n\n\thandleChangeInfo = () => {\n\n\t\n\t\tlet street;\n\t\tlet city;\n\t\tlet country;\n\t\tlet latitude;\n\t\tlet longitude;\n\t\tlet address1;\n\t\tlet postCode ='10000';\n\n        address1= this.addressInput.current.value;\n\t\tvar com=address1.split(\",\");\n\t\tconsole.log(com[0]);\n\t\tthis.ymaps\n\t\t\t.geocode(this.addressInput.current.value)\n\t\t\t.then(function (res) {\n\t\t\t\tvar addressObject = res.geoObjects.get(0),\n\t\t\t\t\tcoords = addressObject.geometry.getCoordinates();\n\t\t\t\tlatitude = coords[0];\n\t\t\t\tlongitude = coords[1];\n\t\t\t\tcountry = addressObject.getCountry();\n\t\t\t\tstreet = addressObject.getThoroughfare();\n\t\t\t\tcity = addressObject.getLocalities().join(\", \");\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tlet phId = this.state.phId;\n\t\t\t\tlet pharmacyDTO = {\n\t\t\t\t\tname: this.state.nameOfPharmacy,\n\t\t\t\t\taddress: { city, street, country,postCode, latitude, longitude },\n\t\t\t\t\tdescription: this.state.description,\n\t\t\t\t\tconsultationPrice: this.state.consultationPrice,\n\t\t\t\t};\n\n\n\t\t\t\tif (this.validateForm(pharmacyDTO)) {\n\t\t\t\t\tAxios.put(API_URL + \"/pharmacy/editPharmacy/\"+phId,pharmacyDTO ,{\n\n\t\t\t\t\t\tvalidateStatus: () => true, headers: { Authorization: GetAuthorisation() } })\n\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\tif (res.status === 400) {\n\t\t\t\t\t\t\t\tthis.setState({ showModalErr : true });\n\t\t\t\t\t\t\t} else if (res.status === 204) {\n\t\t\t\t\t\t\t\tconsole.log(\"Success\");\n\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tshowModal : true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\tvalidateForm = (pharmacyDTO) => {\n\t\tthis.setState({\n\t\t\tnameError: \"none\",\n\t\t\tdescriptionError: \"none\",\n\t\t\taddressError: \"none\",\n\t\t\tconsultationPriceError: \"none\",\n\t\t});\n\n\t\tif (pharmacyDTO.name === \"\") {\n\t\t\tthis.setState({ nameError: \"initial\" });\n\t\t\treturn false;\n\t\t} else if (pharmacyDTO.description === \"\") {\n\t\t\tthis.setState({ descriptionError: \"initial\" });\n\t\t\treturn false;\n\t\t} else if (this.addressInput.current.value === \"\") {\n\t\t\tthis.setState({ addressError: \"initial\" });\n\t\t\treturn false;\n\t\t} else if (pharmacyDTO.consultationPrice === \"\") {\n\t\t\tthis.setState({ consultationPriceError: \"initial\" });\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t};\n\n\tisEditableInfoFields = () => {\n\t\tthis.setState({isEditable: true });\n\t};\n\n\tcomponentDidMount() {\n        this.addressInput = React.createRef();\n\n\t\tAxios.get(API_URL + \"/pharmacy/pharmacyInfo/\"+localStorage.getItem(\"keyPharmacyId\"),{\n\t\t\theaders: { Authorization: GetAuthorisation() },\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tthis.setState({\n\t\t\t\t\tpharmacy: response.data,\n\t\t\t\t\tphId: response.data.Id,\n\t\t\t\t\tnameOfPharmacy: response.data.EntityDTO.name,\n\t\t\t\t\tdescription: response.data.EntityDTO.description,\n                    \n                    address: response.data.EntityDTO.address,\n\t\t\t\t\n\t\t\t\t\tlat: response.data.EntityDTO.address.latitude,\n\t\t\t\t\tlong: response.data.EntityDTO.address.longitude,\n                    grade: response.data.EntityDTO.grade,\n                    consultationPrice: response.data.EntityDTO.price\n\t\t\t\t});\n\t\t\t\tconsole.log(this.state.address.latitude);\n\t\t\t\tconsole.log(this.state.address.longitude        );\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(err);\n\t\t\t});\n\t\t\t\n\t\t\n    }\n    \n\n\thandleNameChange = (event) => {\n\t\tthis.setState({ nameOfPharmacy: event.target.value });\n\t};\n\n\thandleDescriptionChange= (event) => {\n\t\tthis.setState({ description: event.target.value });\n\t};\n\n\thandleConsultationPriceChange = (event) => {\n\t\tthis.setState({ consultationPrice: event.target.value });\n\t};\n\n\t\n\thandleCloseModal = () => {\n\t\tthis.setState({ showModal: false ,showModalErr: false});\n\t};\n\n\n\t\n\t\n\n\taddressSuggestView = (ymaps) => {\n\t\tthis.ymaps = ymaps;\n\n\t\tif (this.state.address !== \"\") {\n\t\t\tthis.ymaps\n\t\t\t\t.geocode([this.state.address.latitude, this.state.address.longitude])\n\t\t\t\t.then(function (res) {\n\t\t\t\t\tvar firstGeoObject = res.geoObjects.get(0);\n\t\t\t\t\tdocument.getElementById(\"suggest\").setAttribute(\"value\", firstGeoObject.getAddressLine());\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t\tconst suggestView = new ymaps.SuggestView(\"suggest\");\n\t\t\t\n\t\t}\n\t};\n\t\t\n\trender() {\n\t\t\n\t\t\n\t\tconst nameOfPharmacy=this.state.nameOfPharmacy;\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t\n\t\t\t\t<Header />\n\n\t\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t<div className=\"col-xs-8\" style={{marginLeft:'3%'}}>\n\t\t\t\t\t\n\t\t\t\t\t\t<YMaps query={{load: \"package.full\",lang: \"en_US\",apikey: \"b0ea2fa3-aba0-4e44-a38e-4e890158ece2\"}}>\n        \t\t\t\t\t\t\t\t<Map width=\"33em\" height=\"470px\"\n          \t\t\t\t\t\t\t\tonLoad={this.addressSuggestView}\n          \t\t\t\t\t\t\t\tdefaultState={{ center: [this.state.lat, this.state.long], zoom: 15 }}\n         \t\t\t\t\t\t\t\t modules={[\"SuggestView\"]}\n        \t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Placemark geometry={[this.state.lat, this.state.long]}  properties={{ balloonContent: this.state.nameOfPharmacy }}/>\n\t\t\t\t\t\t\t\t\t\t</Map>\n     \t\t\t\t\t\t\t\t\t </YMaps>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\n\n\t\t\t\t\n\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n\nexport default PharmacyPage;\n"]},"metadata":{},"sourceType":"module"}